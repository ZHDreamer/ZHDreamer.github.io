<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="msvalidate.01" content="F6AEE664C45CEBD9B20F0FF05746437D">
  <meta name="baidu-site-verification" content="code-F3T999W6or">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic%7CSource+Code+Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhdreamer.github.io","root":"/","images":"/images","scheme":"Mist","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="Scheme List Scheme List Definition A scheme list is either:  nil composed of a first element (car) and the rest (cdr) of the scheme list">
<meta property="og:type" content="article">
<meta property="og:title" content="20 More Scheme">
<meta property="og:url" content="https://zhdreamer.github.io/project/2022/01/02/20-More-Scheme/index.html">
<meta property="og:site_name" content="数字云烟">
<meta property="og:description" content="Scheme List Scheme List Definition A scheme list is either:  nil composed of a first element (car) and the rest (cdr) of the scheme list">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/ZHDreamer/markdown-images/raw/master/images/Snipaste_2021-11-14_12-41-56.png">
<meta property="article:published_time" content="2022-01-02T02:28:13.000Z">
<meta property="article:modified_time" content="2022-01-03T05:25:18.497Z">
<meta property="article:author" content="ZHDreamer">
<meta property="article:tag" content="note">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/ZHDreamer/markdown-images/raw/master/images/Snipaste_2021-11-14_12-41-56.png">


<link rel="canonical" href="https://zhdreamer.github.io/project/2022/01/02/20-More-Scheme/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zhdreamer.github.io/project/2022/01/02/20-More-Scheme/","path":"2022/01/02/20-More-Scheme/","title":"20 More Scheme"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>20 More Scheme | 数字云烟</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">数字云烟</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#scheme-list"><span class="nav-number">1.</span> <span class="nav-text">Scheme List</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#scheme-list-definition"><span class="nav-number">1.1.</span> <span class="nav-text">Scheme List Definition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#creating-scheme-lists"><span class="nav-number">1.2.</span> <span class="nav-text">Creating Scheme Lists</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#checking-equivalence"><span class="nav-number">1.3.</span> <span class="nav-text">Checking Equivalence</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#list-constructor"><span class="nav-number">1.4.</span> <span class="nav-text">List Constructor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#quoting"><span class="nav-number">1.5.</span> <span class="nav-text">Quoting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#add-to-end"><span class="nav-number">1.6.</span> <span class="nav-text">Add To End</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tail-recursion"><span class="nav-number">2.</span> <span class="nav-text">Tail Recursion</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#identifying-tail-contexts"><span class="nav-number">2.1.</span> <span class="nav-text">Identifying Tail Contexts</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#recursive-frames"><span class="nav-number">2.2.</span> <span class="nav-text">Recursive frames</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#tail-calls"><span class="nav-number">2.2.1.</span> <span class="nav-text">Tail calls</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZHDreamer</p>
  <div class="site-description" itemprop="description">一位完美主义偏执狂的博客</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhdreamer.github.io/project/2022/01/02/20-More-Scheme/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZHDreamer">
      <meta itemprop="description" content="一位完美主义偏执狂的博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="数字云烟">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          20 More Scheme
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-02 10:28:13" itemprop="dateCreated datePublished" datetime="2022-01-02T10:28:13+08:00">2022-01-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP/" itemprop="url" rel="index"><span itemprop="name">SICP</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SICP/CS61-A/" itemprop="url" rel="index"><span itemprop="name">CS61-A</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="scheme-list">Scheme List</h2>
<h3 id="scheme-list-definition">Scheme List Definition</h3>
<p>A scheme list is either:</p>
<ul>
<li>nil</li>
<li>composed of a first element (car) and the rest (cdr) of the scheme list</li>
</ul>
<p><img src="https://gitee.com/ZHDreamer/markdown-images/raw/master/images/Snipaste_2021-11-14_12-41-56.png" /></p>
<span id="more"></span>
<h3 id="creating-scheme-lists">Creating Scheme Lists</h3>
<p><code>(cons 1 (cons 2 (cons 3 nil)))</code></p>
<h3 id="checking-equivalence">Checking Equivalence</h3>
<p><code>(eqial? e1 e2)</code> is like <code>==</code> in Python</p>
<p><code>(eq? e1 e2)</code> is like <code>is</code> in Python (only matters for lists in scheme)</p>
<p><code>(= e1 e2)</code> only works for numbers</p>
<h3 id="list-constructor">List Constructor</h3>
<p>The list constructor takes in any number of elements and puts each elements a single element in a list.</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scm&gt; (<span class="name"><span class="builtin-name">list</span></span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>)</span><br><span class="line">(<span class="name">1</span> <span class="number">2</span> <span class="number">3</span>)</span><br><span class="line">scm&gt; (<span class="name"><span class="builtin-name">cons</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">cons</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">cons</span></span> <span class="number">3</span> nil)))</span><br><span class="line">(<span class="name">1</span> <span class="number">2</span> <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h3 id="quoting">Quoting</h3>
<p>The quote special form takes in a single argument and returns an <strong>unevaluated</strong> version of the argument.</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scm&gt; <span class="symbol">&#x27;a</span></span><br><span class="line">a</span><br><span class="line">scm&gt; (<span class="name"><span class="builtin-name">define</span></span> a &#x27;(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>))</span><br><span class="line">a</span><br><span class="line">scm&gt; a</span><br><span class="line">(<span class="name">1</span> <span class="number">2</span> <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h3 id="add-to-end">Add To End</h3>
<p>Given a scheme list <code>lst</code> and an element <code>x</code> add <code>x</code> to the end of <code>lst</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">defin</span> (<span class="name">add-to-end</span> lst x)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> lst)</span><br><span class="line">        (<span class="name"><span class="builtin-name">list</span></span> x)</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">null?</span></span> (<span class="name"><span class="builtin-name">cdr</span></span> lst))</span><br><span class="line">            (<span class="name"><span class="builtin-name">cons</span></span> (<span class="name"><span class="builtin-name">car</span></span> lst) (<span class="name">add-to-end</span> (<span class="name"><span class="builtin-name">cdr</span></span> lst) x))</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="tail-recursion">Tail Recursion</h2>
<ul>
<li>An expression in a <strong>tail context</strong> is evaluated as the last step the function call
<ul>
<li>That means nothing is evaluated/applied after it is evaluated</li>
</ul></li>
<li>Function calls in a tail context are called <strong>tail calls</strong></li>
<li>If all recursive calls are in tail contexts, we say that function is <strong>tail recursive</strong>
<ul>
<li>If a language supports tail call optimization, a tail recursive function will only ever open a constant number of frames</li>
</ul></li>
</ul>
<p>Python has no tail call optimization, but scheme support.</p>
<h3 id="identifying-tail-contexts">Identifying Tail Contexts</h3>
<p>An expression is in a tail context only if it is the last thing evaluated in <strong>every possible scenario</strong>.</p>
<h3 id="recursive-frames">Recursive frames</h3>
<p>non-tail recersive Every frame need to be opened to wait for the return value. Because recursive call isn't the last thing to be evaluated, their is still * to be applied.</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fact</span> n)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>)</span><br><span class="line">        <span class="number">1</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">*</span></span> n (<span class="name">fact</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="tail-calls">Tail calls</h4>
<p>In this recursive call, the helper function is the last thing to be evaluated. So every frame don't need to open to calculate the return value. It just return what helper function return to it. <figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fact</span> n)</span><br><span class="line">    (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fact-tail</span> n result)</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> n <span class="number">1</span>)</span><br><span class="line">            result</span><br><span class="line">            (<span class="name">fact-tail</span> (<span class="name">-n</span> <span class="number">1</span>) (<span class="name"><span class="builtin-name">*</span></span> n result))</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    (<span class="name">fact-tail</span> n <span class="number">1</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure> ### Writing Tail Recursive Functions 1. Identify recursive calls that are not in a tail context. - The last body subexpression in a <code>lambda</code> - the consequent and alternative in a tail context <code>if</code> - All non-predicate sub-expressions in a tail context <code>cond</code> - The last sub-expression in a taill context <code>and</code>, <code>or</code>, <code>begin</code> or <code>let</code> 2. Create a helper function with arguments to accumulate the computation that prevents it from being tail recursive.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/note/" rel="tag"><i class="fa fa-tag"></i> note</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/11/14/19-Scheme/" rel="prev" title="19 Scheme">
                  <i class="fa fa-chevron-left"></i> 19 Scheme
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/01/03/22-Macros/" rel="next" title="22 Macros">
                  22 Macros <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZHDreamer</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">59k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">54 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>




  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
